package com.jmansilla.management;

import java.time.LocalTime;

import org.springframework.mail.javamail.JavaMailSender;
import org.thymeleaf.TemplateEngine;

import de.codecentric.boot.admin.server.domain.entities.Instance;
import de.codecentric.boot.admin.server.domain.entities.InstanceRepository;
import de.codecentric.boot.admin.server.domain.events.InstanceEvent;
import de.codecentric.boot.admin.server.notify.MailNotifier;
import reactor.core.publisher.Mono;

public class MailNotifierCustom extends MailNotifier{

	public MailNotifierCustom(JavaMailSender mailSender, InstanceRepository repository, TemplateEngine templateEngine) {
		super(mailSender, repository, templateEngine);
		// TODO Auto-generated constructor stub
	}

	 
	 protected Mono<Void> doNotify(InstanceEvent event, Instance instance) {
		 LocalTime hora = LocalTime.now();
		 
		 if (hora.getHour() > 1) {
			System.out.println("Hora menor que la 1 lanzamos la notificación.");
			return super.doNotify(event, instance);
		 } else {
			 System.out.println("fuera de hora no lanzamos la notificación");
		 }
		 
		 return Mono.empty();
	 }
}
